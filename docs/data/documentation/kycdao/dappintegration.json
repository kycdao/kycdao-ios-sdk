{"primaryContentSections":[{"kind":"content","content":[{"anchor":"Overview","level":2,"type":"heading","text":"Overview"},{"type":"paragraph","inlineContent":[{"type":"text","text":"This article provides a guide for integrating the SDK into an app that is not a wallet. Signing and minting will be performed by a separate wallet app, which will have to be connected to the SDK. For this task, the SDK uses WalletConnect."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Three main topics will be discussed here:"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Connecting to a wallet"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Checking the KYC status of an address"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Implementing the KYC flow from identity verification till minting"}]}]}]},{"anchor":"Connecting-to-a-wallet","level":2,"type":"heading","text":"Connecting to a wallet"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Connecting to a wallet starts with the "},{"type":"reference","isActive":true,"identifier":"doc:\/\/KycDao\/documentation\/KycDao\/WalletConnectManager"},{"type":"text","text":" having to actively listen for peers (wallets) which will accept our session offer."}]},{"type":"codeListing","syntax":"swift","code":["WalletConnectManager.shared.startListening()"]},{"type":"paragraph","inlineContent":[{"type":"text","text":"The "},{"type":"reference","isActive":true,"identifier":"doc:\/\/KycDao\/documentation\/KycDao\/WalletConnectManager"},{"type":"text","text":" will keep waiting for new connections and emit "},{"type":"reference","isActive":true,"identifier":"doc:\/\/KycDao\/documentation\/KycDao\/WalletConnectSession"},{"type":"text","text":" objects on successful connections. We can subscribe for these session creation events using"}]},{"type":"codeListing","syntax":"swift","code":["WalletConnectManager.shared.sessionStarted","    .receive(on: DispatchQueue.main)","    .sink { [weak self] walletSession in","        \/\/Do something with walletSession","    }.store(in: &disposeBag)"]},{"type":"paragraph","inlineContent":[{"type":"text","text":"You have two options to connect your user’s wallet to the kycDAO SDK:"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Present them a QR Code they can scan"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Show them a list of supported wallet apps, where they can manually select their own"}]}]}]},{"anchor":"Connecting-through-QR-Code","level":3,"type":"heading","text":"Connecting through QR Code"},{"type":"paragraph","inlineContent":[{"type":"text","text":"The QR Code for WalletConnect is an URI. This URI will change over time: "},{"type":"reference","isActive":true,"identifier":"doc:\/\/KycDao\/documentation\/KycDao\/WalletConnectSession"},{"type":"text","text":" creation or rejection will result in the URI being refreshed, awaiting new connections on the new URI."}]},{"type":"codeListing","syntax":"swift","code":["WalletConnectManager.shared.pendingSessionURI","    .receive(on: DispatchQueue.main)","    .sink { [weak self] uri in","        self?.setQR(uri)","    }.store(in: &disposeBag)"]},{"type":"paragraph","inlineContent":[{"type":"text","text":"This is a possible implementation of how you could create an image from any "},{"type":"codeVoice","code":"String"},{"type":"text","text":" and add it to an "},{"type":"codeVoice","code":"UIImageView"}]},{"type":"codeListing","syntax":"swift","code":["func setQR(_ code: String) {","    let data = Data(code.utf8)","    let context = CIContext()","    let filter = CIFilter.qrCodeGenerator()","    filter.setValue(data, forKey: \"inputMessage\")","","    guard let outputImage = filter.outputImage else {","        return","    }","    ","    let scaledImage = outputImage.transformed(by: CGAffineTransform(scaleX: 4, y: 4))","    ","    if let cgImage = context.createCGImage(scaledImage, from: scaledImage.extent) {","        qrImageView.layer.magnificationFilter = CALayerContentsFilter.nearest","        qrImageView.image = UIImage(cgImage: cgImage)","    }","}"]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Once the user scans the QR in their wallet and accepts the connection, "},{"type":"reference","isActive":true,"identifier":"doc:\/\/KycDao\/documentation\/KycDao\/WalletConnectManager\/sessionStarted"},{"type":"text","text":" will emit the session object of the connection and "},{"type":"reference","isActive":true,"identifier":"doc:\/\/KycDao\/documentation\/KycDao\/WalletConnectManager\/pendingSessionURI"},{"type":"text","text":" will emit the URI for the next possible connection."}]},{"anchor":"Connecting-through-the-wallet-app-list","level":3,"type":"heading","text":"Connecting through the wallet app list"},{"type":"paragraph","inlineContent":[{"type":"text","text":"To get a list of supported wallets you should call"}]},{"type":"codeListing","syntax":"swift","code":["let wallets = try await WalletConnectManager.listWallets()"]},{"type":"paragraph","inlineContent":[{"type":"text","text":"which returns an array of "},{"type":"reference","isActive":true,"identifier":"doc:\/\/KycDao\/documentation\/KycDao\/Wallet"},{"type":"text","text":" models."},{"type":"text","text":" "},{"type":"text","text":"You can display the image and name of these wallets, let the user select their preferred wallet, then"}]},{"type":"codeListing","syntax":"swift","code":["try WalletConnectManager.shared.connect(withWallet: selectedWallet)"]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Once the wallet is launched and the user accepts the connection, "},{"type":"reference","isActive":true,"identifier":"doc:\/\/KycDao\/documentation\/KycDao\/WalletConnectManager\/sessionStarted"},{"type":"text","text":" will emit the session object of the connection and "},{"type":"reference","isActive":true,"identifier":"doc:\/\/KycDao\/documentation\/KycDao\/WalletConnectManager\/pendingSessionURI"},{"type":"text","text":" will emit the URI for the next possible connection."}]},{"anchor":"Check-KYC-status-of-an-address","level":2,"type":"heading","text":"Check KYC status of an address"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Depending from your usecase, you have two options."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"If you already obtained the user’s wallet address and know the chain they possibly minted their KYC NFT on, you should"}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"If the user’s wallet address is unknown, you can get a connection through WalletConnectManager to their wallet and use the WalletConnectSession object to ask for their KYC status."}]},{"anchor":"Use-WalletConnectSession","level":3,"type":"heading","text":"Use WalletConnectSession"},{"type":"paragraph","inlineContent":[{"type":"reference","isActive":true,"identifier":"doc:\/\/KycDao\/documentation\/KycDao\/WalletConnectSession"},{"type":"text","text":" contains a blockchain account list (wallet addresses), with all the accounts returned by WalletConnect for the connection with the wallet app. The user should select their address from "},{"type":"reference","isActive":true,"identifier":"doc:\/\/KycDao\/documentation\/KycDao\/WalletConnectSession\/accounts"},{"type":"text","text":" if there are more than one available, otherwise the one available address can be used."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Once we obtained the wallet address, we can call"}]},{"type":"codeListing","syntax":"swift","code":["let hasValidToken = try await KYCManager.shared.hasValidToken(verificationType: .kyc,","                                                              walletAddress: selectedAddress,","                                                              walletSession: walletConnectSession)"]},{"anchor":"Using-existing-wallet-information","level":3,"type":"heading","text":"Using existing wallet information"},{"type":"paragraph","inlineContent":[{"type":"text","text":"A "},{"type":"reference","isActive":true,"identifier":"doc:\/\/KycDao\/documentation\/KycDao\/NetworkOptions"},{"type":"text","text":" object have to be constructed specifying the chain in CAIP-2 format and an RPC URL can be optionally provided, read more about it "},{"type":"strong","inlineContent":[{"type":"text","text":"here"}]},{"type":"text","text":"."}]},{"type":"codeListing","syntax":"swift","code":["let networkOptions = NetworkOptions(chainId: \"eip155:80001\")","let hasValidToken = try await KYCManager.shared.hasValidToken(verificationType: .kyc,","                                                              walletAddress: walletAddress,","                                                              networkOptions: networkOptions)"]}]}],"schemaVersion":{"major":0,"minor":3,"patch":0},"sections":[],"variants":[{"paths":["\/documentation\/kycdao\/dappintegration"],"traits":[{"interfaceLanguage":"swift"}]}],"identifier":{"url":"doc:\/\/KycDao\/documentation\/KycDao\/DAppIntegration","interfaceLanguage":"swift"},"kind":"article","metadata":{"roleHeading":"Article","title":"DApp and Web2 Integration","role":"article","modules":[{"name":"KycDao"}]},"hierarchy":{"paths":[["doc:\/\/KycDao\/documentation\/KycDao"]]},"seeAlsoSections":[{"title":"Articles","identifiers":["doc:\/\/KycDao\/documentation\/KycDao\/Installation"],"generated":true}],"references":{"doc://KycDao/documentation/KycDao/WalletConnectManager":{"role":"symbol","title":"WalletConnectManager","fragments":[{"kind":"keyword","text":"class"},{"kind":"text","text":" "},{"kind":"identifier","text":"WalletConnectManager"}],"abstract":[{"type":"text","text":"A WalletConnect V1 compatibility support class. Use this, if you want to connect the KYC flow to a wallet through WalletConnect"}],"identifier":"doc:\/\/KycDao\/documentation\/KycDao\/WalletConnectManager","kind":"symbol","type":"topic","navigatorTitle":[{"kind":"identifier","text":"WalletConnectManager"}],"url":"\/documentation\/kycdao\/walletconnectmanager"},"doc://KycDao/documentation/KycDao/WalletConnectManager/pendingSessionURI":{"role":"symbol","title":"pendingSessionURI","fragments":[{"kind":"keyword","text":"var"},{"kind":"text","text":" "},{"kind":"identifier","text":"pendingSessionURI"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"AnyPublisher","preciseIdentifier":"s:7Combine12AnyPublisherV"},{"kind":"text","text":"<"},{"kind":"typeIdentifier","text":"String","preciseIdentifier":"s:SS"},{"kind":"text","text":"?, "},{"kind":"typeIdentifier","text":"Never","preciseIdentifier":"s:s5NeverO"},{"kind":"text","text":">"}],"abstract":[{"type":"text","text":"Publisher that emits session URIs on which the WalletConnect component is currently awaiting new connections."}],"identifier":"doc:\/\/KycDao\/documentation\/KycDao\/WalletConnectManager\/pendingSessionURI","kind":"symbol","type":"topic","url":"\/documentation\/kycdao\/walletconnectmanager\/pendingsessionuri"},"doc://KycDao/documentation/KycDao/WalletConnectSession":{"role":"symbol","title":"WalletConnectSession","fragments":[{"kind":"keyword","text":"class"},{"kind":"text","text":" "},{"kind":"identifier","text":"WalletConnectSession"}],"abstract":[{"type":"text","text":"A class representing a session with a WalletConnect wallet"}],"identifier":"doc:\/\/KycDao\/documentation\/KycDao\/WalletConnectSession","kind":"symbol","type":"topic","navigatorTitle":[{"kind":"identifier","text":"WalletConnectSession"}],"url":"\/documentation\/kycdao\/walletconnectsession"},"https://registry.walletconnect.com/api/v1/wallets":{"title":"WalletConnect V1 registry","titleInlineContent":[{"type":"text","text":"WalletConnect V1 registry"}],"type":"link","identifier":"https:\/\/registry.walletconnect.com\/api\/v1\/wallets","url":"https:\/\/registry.walletconnect.com\/api\/v1\/wallets"},"doc://KycDao/documentation/KycDao/Installation":{"role":"article","title":"Installation","abstract":[{"type":"text","text":"Adding kycDAO SDK to your project"}],"identifier":"doc:\/\/KycDao\/documentation\/KycDao\/Installation","kind":"article","type":"topic","url":"\/documentation\/kycdao\/installation"},"doc://KycDao/documentation/KycDao/NetworkOptions":{"role":"symbol","title":"NetworkOptions","fragments":[{"kind":"keyword","text":"struct"},{"kind":"text","text":" "},{"kind":"identifier","text":"NetworkOptions"}],"abstract":[{"type":"text","text":"A set of options for any chain"}],"identifier":"doc:\/\/KycDao\/documentation\/KycDao\/NetworkOptions","kind":"symbol","type":"topic","navigatorTitle":[{"kind":"identifier","text":"NetworkOptions"}],"url":"\/documentation\/kycdao\/networkoptions"},"doc://KycDao/documentation/KycDao/WalletConnectSession/accounts":{"role":"symbol","title":"accounts","fragments":[{"kind":"keyword","text":"var"},{"kind":"text","text":" "},{"kind":"identifier","text":"accounts"},{"kind":"text","text":": ["},{"kind":"typeIdentifier","text":"String","preciseIdentifier":"s:SS"},{"kind":"text","text":"]"}],"abstract":[{"type":"text","text":"List of blockchain accounts\/wallet addresses accessible through the session"}],"identifier":"doc:\/\/KycDao\/documentation\/KycDao\/WalletConnectSession\/accounts","kind":"symbol","type":"topic","url":"\/documentation\/kycdao\/walletconnectsession\/accounts"},"doc://KycDao/documentation/KycDao":{"role":"collection","title":"KycDao","abstract":[{"type":"text","text":"On-chain KYC - Bridge IRL to web3"}],"identifier":"doc:\/\/KycDao\/documentation\/KycDao","kind":"symbol","type":"topic","url":"\/documentation\/kycdao"},"doc://KycDao/documentation/KycDao/WalletConnectManager/sessionStarted":{"role":"symbol","title":"sessionStarted","fragments":[{"kind":"keyword","text":"var"},{"kind":"text","text":" "},{"kind":"identifier","text":"sessionStarted"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"AnyPublisher","preciseIdentifier":"s:7Combine12AnyPublisherV"},{"kind":"text","text":"<"},{"kind":"typeIdentifier","text":"WalletConnectSession","preciseIdentifier":"s:6KycDao20WalletConnectSessionC"},{"kind":"text","text":", "},{"kind":"typeIdentifier","text":"Never","preciseIdentifier":"s:s5NeverO"},{"kind":"text","text":">"}],"abstract":[{"type":"text","text":"Publisher that emits session objects when connections to wallets are established"}],"identifier":"doc:\/\/KycDao\/documentation\/KycDao\/WalletConnectManager\/sessionStarted","kind":"symbol","type":"topic","url":"\/documentation\/kycdao\/walletconnectmanager\/sessionstarted"},"doc://KycDao/documentation/KycDao/Wallet":{"role":"symbol","title":"Wallet","fragments":[{"kind":"keyword","text":"struct"},{"kind":"text","text":" "},{"kind":"identifier","text":"Wallet"}],"abstract":[{"type":"text","text":"A model that describes a wallet for the SDK usable with WalletConnect."},{"type":"text","text":" "},{"type":"text","text":"The data provided in the model is derived from the "},{"type":"reference","isActive":true,"identifier":"https:\/\/registry.walletconnect.com\/api\/v1\/wallets"}],"identifier":"doc:\/\/KycDao\/documentation\/KycDao\/Wallet","kind":"symbol","type":"topic","navigatorTitle":[{"kind":"identifier","text":"Wallet"}],"url":"\/documentation\/kycdao\/wallet"}}}